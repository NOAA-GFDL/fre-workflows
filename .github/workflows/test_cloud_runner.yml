name: run_ppp

on: [push]

# cancel running jobs if theres a newer push
#concurrency:
#  group: ${{ github.workflow }}-${{ github.ref }}
#  cancel-in-progress: true

jobs:
  test-cloud:
    runs-on: self-hosted
    steps:
      - uses: actions/checkout@v4
      #- name: Set up Python
      #  uses: actions/setup-python@v5
      #  with:
      #    python-version: '>=3.9'
      - name: Run test script
        run: |
          # Print pwd then run script
          echo "Currently in:"
          #cat ./flow.cylc
          # exit 0
          pwd
          #ls -lah
          cd /contrib/Ciheim.Brown/ppp
          #singularity exec --writable-tmpfs --bind ./ppp-setup/:/mnt --bind ./ppp-setup/history:/mnt/history:ro --bind ./ppp-setup/c96_OM4_025_grid_No_mg_drag_v20160808.tar:/mnt/c96_OM4_025_grid_No_mg_drag_v20160808.tar ./ppp-7-16-25.sif ./runscript.sh
          singularity exec --writable-tmpfs --bind ./ppp-setup/:/mnt --bind ./ppp-setup/history:/mnt/history:ro --bind ./ppp-setup/c96_OM4_025_grid_No_mg_drag_v20160808.tar:/mnt/c96_OM4_025_grid_No_mg_drag_v20160808.tar ./ppp-7-16-25.sif /contrib/GITHUB_RUNNER_CONFIG_DONT_TOUCH/actions-runner/_work/fre-workflows/fre-workflows/runscript.sh
          grep -r "=ERR" /mnt/ppp-setup/cylc-run
          # /contrib/runnertest.sh
